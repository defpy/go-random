#!/bin/bash
# organize files by extension, e.g. [mp4] - folder 
IFS=$'\t\n'
ACT=$1
EXTENSIONS=/tmp/extension$$
UNDOFOLDER=/tmp/undofolder$$
FILTER=/tmp/extension-tmp$$
organize_them()
{
filext=( )
INPUT=$1
FILES=$(ls -p | grep -v / | grep "[.]" | cut -d . -f $INPUT | tr A-Z a-z | tr -cs 'a-zA-Z0-9' '[\n*]' )
echo "$FILES" > $EXTENSIONS
echo "" > $FILTER

while read i; do
	if [ "$(echo $i | wc -c )" -lt "9" ]; then
		echo "$i"
		txtconf -a $i $FILTER
	else
		echo "NOOO $i"
	fi
done < $EXTENSIONS

while read item; do
	LIST=$(ls -p | grep -v / | grep -i "[.]${item}$")
	if [ "$LIST" != "" ];then
		dname="[type] $item"
		if [ -d "$dname" ]; then
			mv $LIST $dname
		else
			mkdir $dname && mv $LIST $dname || echo "Could not create directory"
		fi
	fi
done < $FILTER
}

undo_organize()
{
	IFS=$'\t\n'
	FOLDER=$(ls | grep "[[type]]")
	echo "$FOLDER" > $UNDOFOLDER
	echo "" >> $UNDOFOLDER
	while read i; do
		if [ -d "$i" ];then
			mv "$i"/* ./ 
			rm -r $i
		fi
	done < $UNDOFOLDER
}

if [ "$ACT" == "-do" ]; then
	NUMBER="2 3 4 5 6 7"
	for i in $NUMBER;do
		organize_them $i
	done
elif [ "$ACT" == "-undo" ]; then
	undo_organize
else
	echo
	echo "organize-folder: move files to different folders ordered by their extensions"
	echo
	echo "([type] extension) e.g. [type] zip, [type] mp4 "
	echo
	echo "options available: -do, -undo"
	echo "    -do"
	echo "    -undo"
	exit 0;
fi






